<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>SzakiChat ‚Äì Regisztr√°ci√≥</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin:0; padding:0;
        background:#f2f2f2;
        font-family:Arial, sans-serif;
    }
    header {
        background:#007aff; color:white;
        padding:18px; text-align:center;
        font-size:22px; font-weight:bold;
    }
    .box {
        max-width:500px; margin:20px auto;
        padding:20px; background:white;
        border-radius:12px;
        box-shadow:0 4px 14px rgba(0,0,0,0.1);
    }
    label { font-weight:bold; display:block; margin-top:12px; }
    input {
        width:100%; margin-top:6px; padding:12px;
        border:1px solid #ccc; border-radius:8px;
        background:#e9f1ff; font-size:16px;
    }
    .btn {
        width:100%; background:#007aff;
        color:white; border:none; border-radius:8px;
        padding:14px; font-size:18px;
        cursor:pointer; font-weight:bold;
        margin-top:20px;
    }
</style>
</head>

<body>

<header>Regisztr√°ci√≥</header>

<div class="box">

    <label>N√©v</label>
    <input id="name" type="text">

    <label>Szakma</label>
    <input id="profession" type="text">

    <label>V√°ros</label>
    <input id="city" type="text">

    <label>Email</label>
    <input id="email" type="email">

    <label>Telefonsz√°m</label>
    <input id="phone" type="text">

    <label>Jelsz√≥</label>
    <input id="pass1" type="password">

    <label>Jelsz√≥ ism√©t</label>
    <input id="pass2" type="password">

    <button class="btn" onclick="registerUser()">Regisztr√°ci√≥</button>

</div>

<!-- üî• Firebase config bet√∂lt√©s -->
<script type="module" src="firebase-config.js"></script>

<!-- üî• Regisztr√°ci√≥s logika -->
<script type="module">

/* --------------------------------------
   FIREBASE IMPORTOK
-------------------------------------- */
import { auth, db } from "./firebase-config.js";

import {
  createUserWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import {
  setDoc, doc
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";


/* --------------------------------------
   REGISZTR√ÅCI√ì ‚Äì JAV√çTOTT FUNKCI√ì
-------------------------------------- */
window.registerUser = async function () {
  const name = document.getElementById("name").value.trim();
  const job = document.getElementById("profession").value.trim();
  const city = document.getElementById("city").value.trim();
  const email = document.getElementById("email").value.trim();
  const pass1 = document.getElementById("pass1").value;
  const pass2 = document.getElementById("pass2").value;
  const phone = document.getElementById("phone").value.trim();

  if (!name || !job || !city || !email || !pass1 || !pass2 || !phone) {
    alert("Minden mez≈ë k√∂telez≈ë!");
    return;
  }

  if (pass1 !== pass2) {
    alert("A k√©t jelsz√≥ nem egyezik!");
    return;
  }

  try {
    const userCred = await createUserWithEmailAndPassword(auth, email, pass1);
    const uid = userCred.user.uid;

    await setDoc(doc(db, "users", uid), {
      role: "user",
      name,
      profession: job,
      city,
      phone,
      shareCount: 0,
      online: false
    });

    alert("Sikeres regisztr√°ci√≥!");
    window.location.href = "user-chat-list.html";

  } catch (err) {
    alert("Hiba t√∂rt√©nt: " + err.message);
  }
};

</script>

</body>
</html>
