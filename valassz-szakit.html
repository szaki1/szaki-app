<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8" />
    <title>Válassz szakembert – Szaki-App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }

        header {
            background: #ff8c00;
            color: #fff;
            padding: 16px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 16px;
        }

        .info-box {
            background: #ffffff;
            padding: 14px 16px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 16px;
            font-size: 14px;
            line-height: 1.4;
        }

        .share-main-btn {
            display: block;
            width: 100%;
            margin-top: 10px;
            padding: 12px;
            border-radius: 10px;
            border: none;
            background: #ff8c00;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }

        .profession-title {
            font-size: 18px;
            font-weight: bold;
            margin: 18px 0 12px;
            color: #333;
        }

        .szaki-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 14px 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 14px;
        }

        .szaki-header-line {
            display: flex;
            justify-content: space-between;
            gap: 12px;
            align-items: baseline;
        }

        .szaki-name {
            font-size: 17px;
            font-weight: bold;
            color: #222;
        }

        .szaki-badge {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 999px;
            background: #ffe6bf;
            color: #8a4b00;
            white-space: nowrap;
        }

        .szaki-profession {
            font-size: 13px;
            color: #555;
            margin-top: 4px;
        }

        .szaki-note {
            font-size: 13px;
            color: #444;
            margin-top: 6px;
        }

        .szaki-phone, .szaki-email {
            font-size: 13px;
            margin-top: 6px;
        }

        .szaki-phone b, .szaki-email b {
            font-weight: bold;
        }

        .szaki-status-online {
            color: #009900;
            font-size: 12px;
            margin-top: 2px;
            font-weight: bold;
        }
        .szaki-status-offline {
            color: #cc0000;
            font-size: 12px;
            margin-top: 2px;
            font-weight: bold;
        }

        .szaki-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .btn-chat, .btn-share {
            flex: 1 1 130px;
            padding: 9px 8px;
            border-radius: 999px;
            border: none;
            font-size: 13px;
            cursor: pointer;
        }

        .btn-chat {
            background: #28a745;
            color: #fff;
            font-weight: bold;
        }

        .btn-share {
            background: #007bff;
            color: #fff;
        }

        .no-result {
            margin-top: 24px;
            font-size: 18px;
            text-align: center;
            color: #333;
        }

    </style>
</head>
<body>

<header>Válassz szakembert</header>

<div class="container">

    <div class="info-box" id="info-text"></div>

    <div id="szaki-lista"></div>
</div>

<script src="szaki-adatok.js"></script>

<script>

    function sharePage() {
        const url = window.location.href;
        if (navigator.share) {
            navigator.share({
                title: "Szaki-App",
                text: "Nézd meg a szakikat a Szaki-App-on!",
                url: url
            }).catch(() => {});
        } else {
            navigator.clipboard.writeText(url);
            alert("Link kimásolva!");
        }
    }

    function openChatWith(szakiName, megrendelonev, szakma) {
        const url =
            "chat.html?sender=" + encodeURIComponent(megrendelonev) +
            "&partner=" + encodeURIComponent(szakiName) +
            "&szakma=" + encodeURIComponent(szakma) +
            "&megrendelonev=" + encodeURIComponent(megrendelonev);

        window.location.href = url;
    }

    (function renderSzakik() {

        const params = new URLSearchParams(window.location.search);
        const szakma = params.get("szakma") || "";
        const megrendelonev = params.get("name") || "Megrendelő";

        const info = document.getElementById("info-text");
        info.innerHTML =
            "<b>Megrendelő neve:</b> " + megrendelonev +
            "<br><b>Keresett szakma:</b> " + szakma +
            "<button class='share-main-btn' onclick='sharePage()'>MEGOSZTÁS</button>";

        const all = window.SzakiAdatok.getAllSzakik();

        const matched = all.filter(s => {
            if (Array.isArray(s.profession)) return s.profession.includes(szakma);
            return s.profession === szakma;
        });

        const container = document.getElementById("szaki-lista");
        container.innerHTML = "";

        if (matched.length === 0) {
            container.innerHTML = '<div class="no-result">Nincs ilyen szakember.</div>';
            return;
        }

        matched.forEach(szaki => {

            const card = document.createElement("div");
            card.className = "szaki-card";

            const headerLine = document.createElement("div");
            headerLine.className = "szaki-header-line";

            const nameEl = document.createElement("div");
            nameEl.className = "szaki-name";
            nameEl.textContent = szaki.name;

            const badge = document.createElement("div");
            badge.className = "szaki-badge";

            if (szaki.name === "Csabi") badge.textContent = "PLATINA – Mester szaki";
            else if (szaki.name === "Zsolti") badge.textContent = "Igazolt szakember";
            else if (!szaki.isReal) badge.textContent = "Betáblázva (demó)";
            else badge.textContent = "Szakember";

            headerLine.appendChild(nameEl);
            headerLine.appendChild(badge);
            card.appendChild(headerLine);

            const prof = document.createElement("div");
            prof.className = "szaki-profession";
            prof.textContent = Array.isArray(szaki.profession)
                ? szaki.profession.join(", ")
                : szaki.profession;
            card.appendChild(prof);

            if (szaki.note) {
                const noteEl = document.createElement("div");
                noteEl.className = "szaki-note";
                noteEl.textContent = szaki.note;
                card.appendChild(noteEl);
            }

            const phoneEl = document.createElement("div");
            phoneEl.className = "szaki-phone";
            phoneEl.innerHTML = "<b>Telefonszám:</b> " + window.SzakiAdatok.getMaskedPhone(szaki);
            card.appendChild(phoneEl);

            const emailEl = document.createElement("div");
            emailEl.className = "szaki-email";
            emailEl.innerHTML = "<b>Email:</b> " + window.SzakiAdatok.getMaskedEmail(szaki);
            card.appendChild(emailEl);

            const onlineLabel = document.createElement("div");
            onlineLabel.className =
                szaki.isOnline ? "szaki-status-online" : "szaki-status-offline";
            onlineLabel.textContent =
                szaki.isOnline ? "ONLINE" : "OFFLINE";
            card.appendChild(onlineLabel);

            const actions = document.createElement("div");
            actions.className = "szaki-actions";

            const chatBtn = document.createElement("button");
            chatBtn.className = "btn-chat";
            chatBtn.textContent = "Chat indítása";
            chatBtn.onclick = () => openChatWith(szaki.name, megrendelonev, szakma);

            const shareBtn = document.createElement("button");
            shareBtn.className = "btn-share";
            shareBtn.textContent = "Megosztás";
            shareBtn.onclick = sharePage;

            actions.appendChild(chatBtn);
            actions.appendChild(shareBtn);
            card.appendChild(actions);

            container.appendChild(card);
        });
    })();

</script>

</body>
</html>
