<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8" />
    <title>Munka r√©szletei ‚Äì Szaki-App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            margin: 0;
            padding: 30px 10px;
        }
        .wrapper {
            max-width: 900px;
            margin: 0 auto 40px;
            background: #ffffff;
            border-radius: 12px;
            padding: 30px 25px 35px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
        }
        h1 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 6px;
        }
        .alcim {
            text-align: center;
            margin: 0 0 25px;
            color: #666;
        }
        .summary-box {
            background: #fff8e1;
            border-radius: 8px;
            padding: 10px 14px;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 22px;
            border: 1px solid #ffe0b2;
        }
        .section-title {
            font-size: 18px;
            margin: 18px 0 4px;
            font-weight: bold;
        }
        .section-subtitle {
            font-size: 13px;
            color: #777;
            margin-bottom: 8px;
        }
        textarea,
        input[type="file"] {
            width: 100%;
            box-sizing: border-box;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
            padding: 10px 12px;
        }
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        .textarea-wrapper {
            position: relative;
        }
        .char-counter {
            position: absolute;
            right: 8px;
            bottom: 6px;
            font-size: 12px;
            color: #999;
        }
        .char-counter.too-short {
            color: #e53935;
            font-weight: bold;
        }
        .mic-button {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 32px;
            height: 32px;
            background: #f57c00;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
            color: #fff;
            font-size: 18px;
        }
        .chips-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0 8px;
        }
        .chip {
            border-radius: 999px;
            border: 1px solid #ccc;
            padding: 6px 12px;
            background: #fafafa;
            cursor: pointer;
            font-size: 13px;
        }
        .chip.selected {
            background: #f57c00;
            border-color: #f57c00;
            color: #fff;
        }
        .checkbox-row {
            margin-top: 10px;
            font-size: 14px;
        }
        .button-row {
            margin-top: 22px;
        }
        .fo-gomb {
            background: #f57c00;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 14px 24px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
        }
        .fo-gomb:hover {
            background: #e56f00;
        }
        .back-link {
            margin-top: 16px;
            text-align: center;
        }
        .back-link a {
            text-decoration: none;
            font-weight: bold;
            color: #f57c00;
        }
        .floating-donate {
            position: fixed;
            right: 16px;
            bottom: 16px;
            background: #ff9800;
            padding: 10px 16px;
            border-radius: 999px;
            font-size: 13px;
            color: white;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>

<div class="wrapper">
    <h1>Munka r√©szletei</h1>
    <p class="alcim">Min√©l r√©szletesebben √≠rod le, ann√°l gyorsabban tal√°lsz megfelel≈ë szakembert.</p>

    <div class="summary-box" id="summaryBox"></div>

    <div class="section-title">1. A munka r√©szletes le√≠r√°sa</div>
    <div class="section-subtitle">(minimum 300 karakter)</div>

    <div class="textarea-wrapper">
        <div id="micButton" class="mic-button">üé§</div>
        <textarea id="reszletesLeiras"></textarea>
        <div id="charCounter" class="char-counter">0 / 300</div>
    </div>

    <div class="section-title">3. Sz√ºks√©ges szakm√°k</div>
    <div class="chips-container" id="szakmaChips">
        <div class="chip" data-value="Burkol√≥">Burkol√≥</div>
        <div class="chip" data-value="Gipszkartonos">Gipszkartonos</div>
        <div class="chip" data-value="Villanyszerel≈ë">Villanyszerel≈ë</div>
        <div class="chip" data-value="V√≠zszerel≈ë">V√≠zszerel≈ë</div>
    </div>

    <div class="checkbox-row">
        <input type="checkbox" id="teljesFelujitas"> Teljes lak√°sfel√∫j√≠t√°s
    </div>

    <div class="section-title">5. √År-√©rdekl≈ëd√©s m√≥dja</div>
    <label>
        <input type="radio" name="priceMode" value="normal" checked> Konkr√©t munk√°t szeretn√©k
    </label>
    <label>
        <input type="radio" name="priceMode" value="onlyPrice"> Csak az √°r √©rdekel (t√°j√©koztat√≥)
    </label>

    <div class="button-row">
        <button class="fo-gomb" onclick="rogzitMunkaDemo()">Munka r√∂gz√≠t√©se (demo)</button>
    </div>

    <div class="back-link">
        ‚Üê <a href="megrendelo-regisztracio.html">Vissza az 1. l√©p√©shez</a>
    </div>

</div>

<div class="floating-donate" onclick="alert('Becs√ºletkassza & megoszt√°s ‚Äì hamarosan!')">
    ü§ù Becs√ºletkassza
</div>

<script type="module">
    import { db } from "./firebase-config.js";
    import { collection, addDoc, serverTimestamp } 
        from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const MIN_LEN = 300;
    const textarea = document.getElementById("reszletesLeiras");
    const counter = document.getElementById("charCounter");

    textarea.addEventListener("input", () => {
        counter.textContent = textarea.value.length + " / " + MIN_LEN;
    });

    const chips = document.getElementById("szakmaChips");
    chips.addEventListener("click", e => {
        const chip = e.target.closest(".chip");
        if (chip) chip.classList.toggle("selected");
    });

    window.rogzitMunkaDemo = async function () {
        const text = textarea.value.trim();
        if (text.length < MIN_LEN) {
            alert("Minimum 300 karakter sz√ºks√©ges!");
            return;
        }

        const szakmak = [...document.querySelectorAll(".chip.selected")]
            .map(c => c.dataset.value);

        const modeInput = document.querySelector('input[name="priceMode"]:checked');
        const priceMode = modeInput ? modeInput.value : "normal";

        const data = {
            description: text,
            trades: szakmak,
            fullRenovation: document.getElementById("teljesFelujitas").checked,
            priceMode: priceMode,
            createdAt: serverTimestamp()
        };

        try {
            const ref = await addDoc(collection(db, "workRequests"), data);
            alert("Munka mentve Firestore-ba! ID: " + ref.id);
        } catch (err) {
            alert("Hiba: " + err);
        }
    };

</script>

</body>
</html>
